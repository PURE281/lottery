<!DOCTYPE html>
<html>
  <head>
    <title>年会抽奖</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <!-- <link rel="stylesheet" href="./index.css"> -->
  </head>

  <body>
    <script src="./lib/three.min.js"></script>
    <script src="./lib/tween.min.js"></script>
    <script src="./lib/TrackballControls.js"></script>
    <script src="./lib/CSS3DRenderer.js"></script>
    <script src="./lib/ajax.js"></script>
    <style>
      .video-control {
        position: fixed;
        /* top: 10vh; */
        right: 4vh;
        z-index: 5;
      }
      .video-box {
        width: 5vh;
        height: 5vh;
        border-radius: 50%;
        text-align: center;
        line-height: 5vh;
        font-size: 1.4vh;
        color: #fff;
        cursor: pointer;
        background-color: rgba(0, 127, 127, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.5);
      }
      .video-rotate-active {
        animation: rotate 4s linear infinite;
      }
    </style>

    <div class="canvas-box">
      <canvas id="canvas">你的浏览器不支持canvas</canvas>
    </div>
    <div style="position: fixed;z-index: 0; width: 100%; height: 100%;">
      <video id="videoPlayer" class="video-item" src="./data/test.mp4" loop autoplay style="width: 100%; height: 100%;opacity: 0.2; filter: blur(0px); object-fit: cover;"></video>
    </div>
    <div class="video-control">
      <div id="videoBox" class="video-box" title="播放/暂停视频">Video</div>
    </div>
    <!-- <div class="music">
      <audio id="music" src="./data/music.mp3" class="music-item" loop></audio>
      <div id="musicBox" class="music-box" title="播放/暂停背景音乐">Music</div>
    </div> -->

    <div id="prizeBar"></div>

    <div id="container"></div>

    <div id="menu">
      <button id="enter">进入抽奖</button>
      <div id="lotteryBar" class="none">
        <button id="lottery">开始抽奖</button>
        <button id="reLottery">重新抽奖</button>
        <div class="fixed-bar">
          <button id="save" class="fixed-btn">导出抽奖结果</button>
          <button id="reset" class="fixed-btn">重置</button>
        </div>
      </div>
    </div>

    <div class="qipao-container"></div>
    <script>
      let onload = window.onload;

      window.onload = function () {
        onload && onload();

        let video = document.querySelector("#videoPlayer");

          
        // 视频控制
        let videoBox = document.querySelector("#videoBox");
        let videoRotated = 0;
        let videoStopAnimate = false;
        
        function animateVideo() {
          requestAnimationFrame(function () {
            if (videoStopAnimate) {
              return;
            }
            videoRotated = videoRotated % 360;
            videoBox.style.transform = "rotate(" + videoRotated + "deg)";
            videoRotated += 1;
            animateVideo();
          });
        }
        animateVideo();
        
        videoBox.addEventListener('click', function () {
          if (video.paused) {
            video.play();
            videoStopAnimate = false;
            animateVideo();
            videoBox.classList.add('video-rotate-active');
          } else {
            video.pause();
            videoStopAnimate = true;
            videoBox.classList.remove('video-rotate-active');
          }
        });
      };
    </script>
  </body>
</html>
